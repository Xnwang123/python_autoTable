import streamlit as st
from utilics import runUtilics
import time

#video_file = open("py_auto_table\videos\web1.mp4","rb")
#video_bytes = video_file.read()
curtime = time.localtime()

with st.sidebar:
    st.title("à¹â€¢á´—â€¢à¹ æ‹›å°±å¤„æ’ç­æ³¨æ„äº‹é¡¹")
    st.divider()
    st.subheader("à¹â€¢á´—â€¢à¹ æ’è¡¨äº‹å®œ")
    st.markdown(
        """
    1ã€æ—©ä¸Šå€¼ç­äººå‘˜æœ€å¤š3äºº(æœ€å¥½2äºº)ï¼Œä¸‹åˆæ—¶é—´æ®µæœ€å¤š4äºº(æœ€å¥½3äºº)ï¼Œæ™šç­æœ€å¥½2äººã€‚\n
    2ã€æ–°åŠ©ç†å’Œå‹¤å·¥å²—äººå‘˜ä¼˜å…ˆæ¯å‘¨æ’ä¸¤ä¸ªæ—¶é—´æ®µï¼Œåœ¨äººæ•°å¤Ÿçš„æƒ…å†µä¸‹ï¼Œè€åŠ©ç†ä¸€å‘¨ä¸€ä¸ªæ—¶é—´æ®µå³å¯(å°½é‡å¤šç»™æ–°äººé”»ç‚¼æœºä¼šï¼‰ã€‚\n
    3ã€æ¯ä¸ªç­æ¬¡ï¼Œå¿…é¡»è‡³å°‘éœ€è¦å®‰æ’è€åŠ©ç†å€¼ç­(é™¤éè¯¥æ—¶é—´æ®µæ— è€åŠ©ç†)ã€‚\n
    4ã€å€¼ç­åˆè¡¨***å‘¨å››***å‘é€åˆ°æ€»ç¾¤ä¸­(å‘é€å‰ï¼Œå…ˆç»™æ’ç­è´Ÿè´£äººæ£€æŸ¥)ï¼Œ ***å‘¨äº”***å‘é€æœ€ç»ˆç‰ˆåˆ°æ€»ç¾¤ï¼Œæœ€ç»ˆç‰ˆç¡®å®šä»¥åï¼Œè¿˜éœ€åˆ¶ä½œ***ç­¾åˆ°è¡¨***ï¼Œå‘é€ç»™æ¯å‘¨ä¸€å¯¹åº”çš„ç»„é•¿ã€‚\n
    5ã€æœ‰éœ€è¦æ›´æ”¹å€¼ç­æ—¶é—´çš„åŠ©ç†ï¼Œæ¥æ”¶æ¶ˆæ¯åï¼Œéœ€è¦å‘ŠçŸ¥å…¶ä»–è´Ÿè´£æ’ç­çš„å°åŠ©ç†ï¼Œä¾¿äºä¿®æ”¹å¯¹åº”çš„æ— è¯¾æ—¶é—´ã€‚\n
    6ã€å‘å®Œæœ€ç»ˆè¡¨ï¼Œéœ€è¦åˆ¶ä½œ ***ç­¾åˆ°è¡¨***å‘ç»™***å‘¨ä¸€***å€¼ç­çš„ç»„é•¿ï¼Œæ³¨æ„æ›´æ”¹***ç­¾åˆ°æ—¶é—´ï¼ï¼ï¼ï¼***
        """
    )
    st.subheader("à¹â€¢á´—â€¢à¹ æ’è¡¨é™„åŠ äº‹é¡¹")
    st.write(
        """
    1ã€éœ€è¦æ‰‹åŠ¨ä»å‘¨ä¸€è‡³å‘¨äº”ä»»æ„é€‰ä¸€å¤©ä»æŸä¸€ç­æ¬¡(æœ€å¥½æ˜¯æ—©ä¸Šã€ä¸‹åˆã€æ™šä¸Šçš„***æœ€åä¸€ç­æˆ–è€…ç¬¬ä¸€ä¸ªç­æ¬¡***)çš„å°ç»„é•¿è´Ÿè´£æœ¬å‘¨***åŠå…¬å®¤å’Œæ¥å¾…å®¤***å«ç”Ÿæ‰“æ‰«ï¼Œå°½é‡æ¯ä½åŠ©ç†è½®ç€æ¥ã€‚(æ¯å‘¨çš„å®‰æ’å¯ä»¥æŒ‰ç…§ ***13542***æ¥ï¼Œ***ä¹Ÿå°±æ˜¯å‘¨ä¸€ã€å‘¨ä¸‰ã€å‘¨äº”ã€å‘¨å››ã€å‘¨äºŒ***)\n
    2ã€æ¯å‘¨éƒ½éœ€è¦å®‰æ’åŠ©ç†æ‰“æ‰«é¢è¯•é—´ï¼Œå°é¢è¯•é—´å®‰æ’ä¸€ä¸ªäººæ‰“æ‰«ï¼Œå¤§é¢è¯•é—´(3å·ï¼Œ8å·)å®‰æ’ä¸¤äººæ‰“æ‰«ã€‚ä¸€èˆ¬å®‰æ’***æ—©ä¸Šç¬¬ä¸€ç­åŠ©ç†***æ‰“æ‰«ä¸€ä¸ªé¢è¯•é—´ï¼Œ***ä¸‹åˆç¬¬äºŒç­åŠ©ç†***æ‰“æ‰«ä¸€ä¸ªé¢è¯•é—´ã€‚**éœ€è¦æ³¨æ„çš„æ˜¯**ï¼Œæœ‰å®‰æ’æ‰“æ‰«åŠå…¬å®¤çš„é‚£å¤©å¯ä»¥ä¸ç”¨å®‰æ’åŠ©ç†æ‰“æ‰«é¢è¯•é—´ã€‚
        """
    )


st.title(f"{curtime[0]}å­¦å¹´æ‹›å°±å¤„å­¦ç”ŸåŠ©ç†æ’ç­ç³»ç»Ÿ")

st.video("py_auto_table/videos/entireweb2.mp4",start_time=0,autoplay=True,loop=True)

st.divider()

st.subheader("ğŸˆè®¾ç½®å„ç­äººå‘˜æ•°ğŸˆ")

columns1,columns2 = st.columns(2)
#è®¾ç½®æ¯ä¸ªæ—¶é—´æ®µå€¼ç­äººæ•°
with columns1:
    to_one = st.slider("à¹â€¢á´—â€¢à¹ æ—©ä¸Šç¬¬ä¸€ç­(1-2)å€¼ç­äººæ•°",min_value=1,max_value=3,step=1,value=2)
    to_two = st.slider("à¹â€¢á´—â€¢à¹ æ—©ä¸Šç¬¬äºŒç­(3-5)å€¼ç­äººæ•°",min_value=2,max_value=4,step=1,value=3)
    nx_one = st.slider("à¹â€¢á´—â€¢à¹ ä¸‹åˆç¬¬ä¸€ç­(6-7)å€¼ç­äººæ•°",min_value=1,max_value=3,step=1,value=2)
with columns2:
    nx_two = st.slider("à¹â€¢á´—â€¢à¹ ä¸‹åˆç¬¬äºŒç­(8-9)å€¼ç­äººæ•°",min_value=2,max_value=4,step=1,value=3)
    night = st.slider("à¹â€¢á´—â€¢à¹ æ™šä¸Šå€¼ç­(10-11)äººæ•°",min_value=0,max_value=2,step=1,value=2)
st.divider()
#è·å–ä¸Šä¼ çš„æ–‡ä»¶
upload_file = st.file_uploader("à¹â€¢á´—â€¢à¹ è¯·ä¸Šä¼ äººå‘˜æ•°æ®è¡¨(200MBä»¥å†…),ä»…æ”¯æŒexcelæ ¼å¼",type=["xlsx","csv"])
#å°†ä¸‰ä¸ªè¡¨æ ¼ç½®äºä¸åŒçš„tabä¸­
tableofworker,tableofstatics,tableofwarning = st.tabs(["å€¼ç­åŠ©ç†å·¥ä½œè¡¨","å€¼ç­åŠ©ç†ç»Ÿè®¡æ•°æ®è¡¨","æ’ç­è­¦å‘Šæç¤ºè¡¨"])

#åˆ¤æ–­æ˜¯å¦ä¸Šä¼ æ–‡ä»¶
if upload_file:
    with st.spinner("æ­£åœ¨åŠ è½½ä¸­...."):
        df_worker,df_statics,df_warning = runUtilics(upload_file,to_one,to_two,nx_one,nx_two,night)
    st.balloons()
#æ˜¾ç¤ºå€¼ç­è¡¨æ•°æ®
with tableofworker:
    if upload_file:
        st.write("à¹â€¢á´—â€¢à¹ ç¨‹åºç”Ÿæˆå€¼ç­è¡¨")
        #è¿™é‡Œçš„.Tä½¿å¾—åŸæœ¬æ•°æ®è¡¨æ ¼ä¸­ï¼Œè¡Œå’Œåˆ—äº’æ¢äº†
        st.table(df_worker.T)
        st.divider()
        st.write("à¹â€¢á´—â€¢à¹ å¾…ä¿®æ”¹å€¼ç­è¡¨(è‹¥æ— ä»»ä½•è­¦å‘Šï¼Œå¯æ— éœ€ä¿®æ”¹ï¼Œç›´æ¥ä¸‹è½½å³å¯)")
        st.data_editor(df_worker.T)
    else:
        st.write("à¹â€¢á´—â€¢à¹ å†…å®¹ä¸ºç©ºï¼Œè¯·ä¸Šä¼ æ–‡ä»¶ï¼")
with tableofstatics:
    if upload_file:
        st.dataframe(df_statics,hide_index=True)
    else:
        st.write("à¹â€¢á´—â€¢à¹ å†…å®¹ä¸ºç©ºï¼Œè¯·ä¸Šä¼ æ–‡ä»¶ï¼")
with tableofwarning:
    if upload_file:
        st.dataframe(df_warning,hide_index=True)
    else:
        st.write("à¹â€¢á´—â€¢à¹ å†…å®¹ä¸ºç©ºï¼Œè¯·ä¸Šä¼ æ–‡ä»¶ï¼")

   
    

